new code developed by gilbert
